<!DOCTYPE html>
<html>
<head>
<title> Standard Changes Spatial Formats Are Broken Replace With New Properties And A New Action |  The Open Effects Association</title>
<link rel="shortcut icon" type="image/x-icon" href="/assets/ofx_favicon-c6cb586c0f8efbaeff3167d1fd7cfca2.ico" />
<link rel="stylesheet" media="all" href="/assets/application-8fbc3aa4b380a52e15d414a59177d3a2.css" />
<script src="/assets/application-f474998312dbf9d63cf3d555583ac5a1.js"></script>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="LG5hDS4Lay5eXQEWQ+V8YS1Lml+//VmYNPSfH/ByshICdAm+iD9mAeuCQ/s318e1eGvuGuaAf3r69Yty5SOzKQ==" />
<meta content='IE=edge' http_equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<script src='//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js'></script>
</head>
<body class='c_standard_changes a_show' data-spy='scroll' data-target='.navbar-top' role='document'>
<div class='modal fade' id='terminal'>
<div class='modal-dialog modal-lg'>
<div class='modal-content'>
<div class='modal-header'>
<div aria-hidden='true' class='button close' data-dismiss='modal' type='button'>&times;</div>
<h4 class='modal-title'>Terminal Output</h4>
</div>
<div class='modal-body'>
<div class='window'></div>
</div>
</div>
</div>
</div>
<div class='wrapper'>
<div class='navbar navbar-inverse navbar-fixed-top' role='components'>
<div class='container'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='sr-only'>Toggle components</span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
</div>
<div class='navbar-collapse collapse'>
<div class='row'>
<div class='navbar-left'>
<div class='navbar-top'>
<div class='mobile'>
<ul class='nav navbar-nav'>
<li><a href="/">Welcome</a></li>
<li><a class="navbar-link" href="/standard_changes">Standards Discussion</a></li>
<li><a class="navbar-link" href="/contact_form">Contact</a></li>
</ul>
</div>
<div class='desktop'>
<ul class='nav navbar-nav'>
<li class='nav-logo'>
<a class="navbar-link" href="/"><img src="/assets/OFX_small-41bc647075217376f758003aebeacf15.png" alt="Ofx small" /></a>
</li>
<li class='dropdown'>
<a href="/">Welcome <span class="glyphicon glyphicon-circle-arrow-left"></span></a>
<ul class='dropdown-menu inverse-dropdown'>
<li>
<a class="navbar-link" href="#standard">Why a Standard?</a>
</li>
<li>
<a class="navbar-link" href="#implementers">For Implementers</a>
</li>
<li>
<a class="navbar-link" href="#organization">Association Business</a>
</li>
</ul>
</li>
<li class='dropdown api'>
<a class='navbar-link'>API Documentation <span class="glyphicon glyphicon-circle-arrow-down"></span></a>
<ul class='dropdown-menu inverse-dropdown'>
<li>
<a class="navbar-link" target="_blank" href="/documentation/api_doc">API Reference</a>
</li>
<li>
<a class="navbar-link" target="_blank" href="https://openfx.readthedocs.io/en/doc/Reference/index.html">Programming Reference</a>
</li>
<li>
<a class="navbar-link" target="_blank" href="https://openfx.readthedocs.io/en/doc/Guide/index.html">Programming Guide</a>
</li>
</ul>
</li>
<li><a class="navbar-link" href="/standard_changes">Standards Discussion</a></li>
<li><a class="navbar-link" href="/contact_form">Contact</a></li>
</ul>
</div>
</div>
</div>
<div class='desktop'>
<form role="form" class="navbar-form navbar-right form-inline" action="/users/sign_in" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="eUAj+1mnUyXu4+bJ2nvxI4eY217rxiYbhflQxCIpmIpXWktI/5NeCls8pCSuSUr30rivG7K7APlL+ESpN3iZsQ==" />
<div class='form-group'>
<input type="text" name="user[email]" id="user_email" class="form-control input-xs" placeholder="Email" />
</div>
<div class='form-group'>
<input type="password" name="user[password]" id="user_password" class="form-control input-xs" placeholder="Password" />
</div>
<button class='btn btn-sm btn-primary' type='submit'>Sign in</button>
</form>

</div>
</div>
</div>
</div>
</div>
<div class='container' role='main'>
</div>
<div class='container'>
<div class='row'>
<div class='col-md-offset-2 col-md-8'>
<div class='btn-group'>
<a type="button" class="btn btn-default" href="/standard_changes"><span class='glyphicon glyphicon-circle-arrow-left'></span> Back to standard change list</a>
</div>

<br>
<br>
<div class='panel panel-warning'>
<div class='panel-heading'>
<h3 class='panel-title'>
Spatial Formats Are Broken, Replace with New Properties and a new Action
<span class='pull-right'>Proposed</span>
</h3>
</div>
<div class='panel-body'>
<p>
<b>Standard version:</b>
1.5
</p>
<p>
<b>Major Change</b>
</p>
<label>Subcommittee</label>
<p><p>Pierre (RE:Vision Effects), Peter Loveday (BMD Fusion)</p></p>
<label>Overview</label>
<p dir="ltr">Regions of definition are well defined concepts within OFX, the &lsquo;format&rsquo; of a clip is not. For example a clip may be HD, 4K, SD etc&hellip; while the RoD need not be congruent to the &lsquo;format&rsquo; at all. Furthermore, effects have no way of changing the spatial format. For example an effect that up scales images from SD to 4K would want to flag the change in format as well as the RoD, otherwise it will be interpreted as a zoom.</p>
<p dir="ltr">The 'format' nomenclature is taken from <strong>Nuke</strong>.</p>
<p dir="ltr">(Pierre: Adding this thread from Nuke dev forum as reference</p>
<p dir="ltr"><a href="http://community.thefoundry.co.uk/discussion/topic.aspx?f=191&amp;t=104638&amp;show=openfx%2cgenerator">http://community.thefoundry.co.uk/discussion/topic.aspx?f=191&amp;t=104638&amp;show=openfx%2cgenerator</a></p>
<p dir="ltr">)</p>
<label>Solution</label>
<p dir="ltr"><span>Currently we use&nbsp;the clip properties </span><em style="font-size: 0.9em;">kOfxImageEffectPropProjectExtent</em><span>, </span><em style="font-size: 0.9em;">kOfxImageEffectPropProjectSize</em><span> and </span><em style="font-size: 0.9em;">kOfxImageEffectPropProjectOffset</em><span> to represent the format. This should be simplified to...</span></p>
<ul>
<li><span><em>kOfxImageEffectImageFormatResolution</em> a 2D integer indicating the resolution in pixels of the output image, this is always full res with no render scale applied,</span></li>
<li><span><em>kOfxImageEffectImageFormatAspectRatio</em> as per normal.</span></li>
</ul>
<p><span><span><span>These are present on all input clips.</span></span></span></p>
<p><span><span><span>We have a new action to compute the format of the output clip,&nbsp;</span><em>kOfxImageEffectActionGetImageFormat</em><span>, which would ask the effect to set the appropriate properties on the </span><span><em>outArgs</em>.</span></span></span></p>
<p>&nbsp;</p>
<p><span><span><span>(pierre adds this suggestion to make this more general purpose): Aside the action, we might want to help make this work in all&nbsp;hosts as it works in that host already when possible: &nbsp;For example, in Nuke there is also a format_knob in their native SDK (NDK)- this shows up as a menu with options for user to select from an existing defined choice of setups and even create new Format presets.&nbsp;</span></span></span></p>
<pre>Format_knob(f, &amp;formats, "format");<br />int, int, double  (W,H,PAR)<br /><br />This would not be directly supportable as presented here. So maybe we need at Descriptor time to check what the host can support. This could be as simple as for overlays - draw or not.<br /><span>kOfxParamPropHasHostOverlayHandle and <span>kOfxParamPropUseHostOverlayHandle (for plugin to know to draw or not 2D point parameters for example). <br /><br />A. This plugin might need to resize output (plugin write  0/1) - Host supports Image Format?&nbsp; (host write 0/1)<br /><br />B. If Host support Image Format and plugin requests that, <br />         then there is another handshake needed: via Action?:<br />                  If yes again, then plugin must set regular parameters and expects an action to set this. (so this must be known during description)<br />                  Else plugin just query that as needed? This would like that create a very "workable solution" where an host that relies on sequence nesting to resize could display for the Format menu for example: match input size | match output size. <br /><br /><br /> </span></span></pre>
</div>
</div>
<div class='btn-group'>
<a type="button" class="btn btn-default" href="/standard_changes"><span class='glyphicon glyphicon-circle-arrow-left'></span> Back to standard change list</a>
</div>

<br>
<br>
<div class='panel panel-default'>
<div class='panel-body'>
<h4 class='text-primary'>Discussion</h4>
<h5>Comments</h5>
<div class='well well-sm'>
<div class='comment user-11' id='cid-271'>
<div class='content'>
<p>Would such suite work for all hosts, some hosts use sequence nesting to make output and input different sizes. Do we need for such host a way for us to request the actual input frame size so that then we don't get a padded or conformed image? Must work for small input in, large out (e.g. a defish that allows you to reveal all the pixels after undistortion), and large input in, small out (e.g. flat window from equirectangular source).&nbsp;I haven't done homework enough to understand all possible OFX hosts (I know Resolve and Catalyst have nesting for example, forget what to expect there) I wonder if it would make sense to make an enumeration with&nbsp; clear expected behavior description so that everyone could fit in somehow, I guess including NONE ? &nbsp;</p>
<p><strong>To be complete here I guess we would need from each host to know how they can best handle this so this can fit all in the way the host can. &nbsp;</strong></p>
<p><strong>Input is 1000&nbsp;x 3000&nbsp;- output is 2000x2000 probably covers this&nbsp;in one example.</strong></p>
<p>&nbsp;</p>
<p>For example an host might not want to support such format action but has a checkbox in their effects control "Use plugin RoD for output size" ,then perhaps they would allow us to programmatically set it up if we had the proper API for that since as an effect I know I am resizing the output buffer not expanding the RoD because I am not like a gaussian blur of 5 - all such things seems to me to indicate that we need to initially request what is supported by host (including if it supports such new action).&nbsp;</p>
<p>So it's clear, I could use the example of a non-OFX host Premiere, where the buffers we get (input and output) are&nbsp;Max of Sequence and Video Track Width and Max of Sequence and Video Track Height (so plugin has to internally crop to remove padding for this to work...). In their case I can still make it work as I know the original layer size (distinct from the image buffer size they pass to us)... &nbsp;In such host instead of input resolution format and output format as 2D integer I would probably want an option menu: Set to <em>kOfxImageEffectPropProjectSize</em>&nbsp;(which I might relabel Sequence Size) and Set to Input Size -- &nbsp;OK I guess you get the idea :)</p>
<p>Alternatively an host might in it's non OFX usage have a Format menu, perhaps this could be supported as well?&nbsp;</p>
<p>This might have interaction with other flags such as multi-resolution support etc</p>
<p>In life in general, I like both things (e.g. increasing the RoD by 5 each margin if a gaussian blur is applied AND changing the actual size) to be distinct, but that's not always an option.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>
</div>
<div class='author text-muted'>
Pierre Jasmin |  7:59 pm,  31 Aug 2016
</div>
</div>

<div class='well well-sm'>
<div class='comment user-11' id='cid-250'>
<div class='content'>
<p>(Pierre Jasmin): Do we need to wait for V2 if we make a V2 version of EffectHandle suite?</p>
<p>Do we need an handshake to know if host supports that?</p>
</div>
</div>
<div class='author text-muted'>
Pierre Jasmin |  5:07 pm,   6 Jun 2015
</div>
</div>

</div>
</div>

<div class='btn-group'>
<a type="button" class="btn btn-default" href="/standard_changes"><span class='glyphicon glyphicon-circle-arrow-left'></span> Back to standard change list</a>
</div>

</div>
</div>
</div>

<div class='push'></div>
</div>
<footer>
<ul class='footer-link-group'>
<li>
<a target="_blank" class="footer-link" href="https://github.com/ofxa/openfx">OFX @ Github</a>
</li>
<li>
<a title="Association details" class="footer-link" href="/contents/page/association_information">Association Information</a>
</li>
</ul>
<br>
Copyright  &copy;2023 The Open Effects Association
</footer>
</body>
</html>
