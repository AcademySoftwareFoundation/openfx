<!DOCTYPE html>
<html>
<head>
<title> Standard Changes Output Clip Constraints |  The Open Effects Association</title>
<link rel="shortcut icon" type="image/x-icon" href="/assets/ofx_favicon-c6cb586c0f8efbaeff3167d1fd7cfca2.ico" />
<link rel="stylesheet" media="all" href="/assets/application-8fbc3aa4b380a52e15d414a59177d3a2.css" />
<script src="/assets/application-f474998312dbf9d63cf3d555583ac5a1.js"></script>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="upBJklL8FHKvsfR9a+RQ9Rw19IdXfHP8dYT7E3dHWf6UiiEh9MgZXRputpAf1ushSRWAwg4BVR67he9+YhZYxQ==" />
<meta content='IE=edge' http_equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<script src='//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js'></script>
</head>
<body class='c_standard_changes a_show' data-spy='scroll' data-target='.navbar-top' role='document'>
<div class='modal fade' id='terminal'>
<div class='modal-dialog modal-lg'>
<div class='modal-content'>
<div class='modal-header'>
<div aria-hidden='true' class='button close' data-dismiss='modal' type='button'>&times;</div>
<h4 class='modal-title'>Terminal Output</h4>
</div>
<div class='modal-body'>
<div class='window'></div>
</div>
</div>
</div>
</div>
<div class='wrapper'>
<div class='navbar navbar-inverse navbar-fixed-top' role='components'>
<div class='container'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='sr-only'>Toggle components</span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
</div>
<div class='navbar-collapse collapse'>
<div class='row'>
<div class='navbar-left'>
<div class='navbar-top'>
<div class='mobile'>
<ul class='nav navbar-nav'>
<li><a href="/">Welcome</a></li>
<li><a class="navbar-link" href="/standard_changes">Standards Discussion</a></li>
<li><a class="navbar-link" href="/contact_form">Contact</a></li>
</ul>
</div>
<div class='desktop'>
<ul class='nav navbar-nav'>
<li class='nav-logo'>
<a class="navbar-link" href="/"><img src="/assets/OFX_small-41bc647075217376f758003aebeacf15.png" alt="Ofx small" /></a>
</li>
<li class='dropdown'>
<a href="/">Welcome <span class="glyphicon glyphicon-circle-arrow-left"></span></a>
<ul class='dropdown-menu inverse-dropdown'>
<li>
<a class="navbar-link" href="#standard">Why a Standard?</a>
</li>
<li>
<a class="navbar-link" href="#implementers">For Implementers</a>
</li>
<li>
<a class="navbar-link" href="#organization">Association Business</a>
</li>
</ul>
</li>
<li class='dropdown api'>
<a class='navbar-link'>API Documentation <span class="glyphicon glyphicon-circle-arrow-down"></span></a>
<ul class='dropdown-menu inverse-dropdown'>
<li>
<a class="navbar-link" target="_blank" href="/documentation/api_doc">API Reference</a>
</li>
<li>
<a class="navbar-link" target="_blank" href="https://openfx.readthedocs.io/en/doc/Reference/index.html">Programming Reference</a>
</li>
<li>
<a class="navbar-link" target="_blank" href="https://openfx.readthedocs.io/en/doc/Guide/index.html">Programming Guide</a>
</li>
</ul>
</li>
<li><a class="navbar-link" href="/standard_changes">Standards Discussion</a></li>
<li><a class="navbar-link" href="/contact_form">Contact</a></li>
</ul>
</div>
</div>
</div>
<div class='desktop'>
<form role="form" class="navbar-form navbar-right form-inline" action="/users/sign_in" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="NwUy7hUr03sDjRXhNBSzaP37618UdNPoDWIV/mBZRZYZH1pdsx/eVLZSVwxAJgi8qNufGk0J9QrDYwGTdQhErQ==" />
<div class='form-group'>
<input type="text" name="user[email]" id="user_email" class="form-control input-xs" placeholder="Email" />
</div>
<div class='form-group'>
<input type="password" name="user[password]" id="user_password" class="form-control input-xs" placeholder="Password" />
</div>
<button class='btn btn-sm btn-primary' type='submit'>Sign in</button>
</form>

</div>
</div>
</div>
</div>
</div>
<div class='container' role='main'>
</div>
<div class='container'>
<div class='row'>
<div class='col-md-offset-2 col-md-8'>
<div class='btn-group'>
<a type="button" class="btn btn-default" href="/standard_changes"><span class='glyphicon glyphicon-circle-arrow-left'></span> Back to standard change list</a>
</div>

<br>
<br>
<div class='panel panel-warning'>
<div class='panel-heading'>
<h3 class='panel-title'>
Output clip constraints
<span class='pull-right'>Proposed</span>
</h3>
</div>
<div class='panel-body'>
<p>
<b>Standard version:</b>
2.0
</p>
<p>
<b>Major Change</b>
</p>
<label>Subcommittee</label>
<p><p>Alexandre - Natron - Inria</p></p>
<label>Overview</label>
<p>The current ImageEffect architecture abstracts what comes out of the effect as the output clip.&nbsp;</p>
<p>Thus the A.P.I makes&nbsp;multiple assumptions that are not clearly indicated as to&nbsp;which&nbsp;functions a plug-in may call on the output clip and when.</p>
<p>For instance:</p>
<p>- The clipGetImage function on the output clip takes the same parameters&nbsp;as if it were called on&nbsp;a source clip, however in reality&nbsp;this function may only be called during the render action and at the same time that was passed to the action.&nbsp;</p>
<p>&nbsp;</p>
<p>-&nbsp;Some plug-ins (BCC Boris FX)&nbsp;inspect some properties on the output clip during that same action used to compute the property, e.g:</p>
<p>They ask for the&nbsp;kOfxImageEffectPropFrameRate on the output clip during the&nbsp;kOfxImageEffectActionGetClipPreferences action when this is actually this action that is used to compute that value, thus involving&nbsp;triggering either an infinite recursion or an undefined behaviour.&nbsp;</p>
<p>&nbsp;</p>
<p>- We've seen some other plug-ins calling&nbsp;asking for the kOfxImageEffectPropRegionOfDefinition property on the output clip during the&nbsp;</p>
<p><span>kOfxImageEffectActionGetRegionOfDefinition itself!&nbsp;Same as above this leads to infinite recursion and undefined behaviour.</span></p>
<p>&nbsp;</p>
<p><span>Such plug-ins clearly are making mistakes because the A.P.I is not constrained enough.&nbsp;</span></p>
<p>&nbsp;</p>
<p>Actually in practise we actually notice that plug-ins only make use of the output clip to&nbsp;</p>
<p>- Fetch the output image</p>
<p>- Fetch properties on the output clip to&nbsp;get informations about the default host implementation if some actions are not implemented &nbsp;(e.g:&nbsp;kOfxImageEffectPropRegionOfDefinition)</p>
<p>&nbsp;</p>
<label>Solution</label>
<p>To solve the output image issue:</p>
<p>The image to render could be passed as an&nbsp;inArg of the render action thus&nbsp;consolidating the context into what things a plug-in is allowed to do.</p>
<p>&nbsp;</p>
<p>For properties on the output clip, the spec should clearly document what property is relevant on the output clip and when it is allowed to inspect that property.</p>
</div>
</div>
<div class='btn-group'>
<a type="button" class="btn btn-default" href="/standard_changes"><span class='glyphicon glyphicon-circle-arrow-left'></span> Back to standard change list</a>
</div>

<br>
<br>
<div class='panel panel-default'>
<div class='panel-body'>
<h4 class='text-primary'>Discussion</h4>
<h5>Comments</h5>
<div class='well well-sm'>
<div class='comment user-11' id='cid-306'>
<div class='content'>
<p>We have a wiki now :) -- would be good to have a flowchart to understand where recursion can happen - including my example on other topic of trying to write a stream of parameters while in InstanceChanged and getting another InstanceChanged each time I add a parameter key. &nbsp;</p>
<p>For example: &nbsp;kOfxImageEffectActionGetTimeDomain -- is it an issue if I can't ask for input clips valid frame range? Say I want to say I can only render the intersection instead of the union of frame ranges (i.e. a generator 2.0 might be input to next node and be infinitely capable...).&nbsp;</p>
<ul class="itemizedlist">
<li class="listitem"><code class="code">inArgs</code>&nbsp;is redundant and is null</li>
<li class="listitem"><code class="code">outArgs</code>&nbsp;has the following property
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem"><a class="link" title="kOfxImageEffectPropFrameRange" href="../documentation/reference/re120.html"><code class="code">kOfxImageEffectPropFrameRange</code>&nbsp;</a>- the frame range an effect can produce images for</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class='author text-muted'>
Pierre Jasmin |  3:43 pm,  13 Feb 2017
</div>
</div>

</div>
</div>

<div class='btn-group'>
<a type="button" class="btn btn-default" href="/standard_changes"><span class='glyphicon glyphicon-circle-arrow-left'></span> Back to standard change list</a>
</div>

</div>
</div>
</div>

<div class='push'></div>
</div>
<footer>
<ul class='footer-link-group'>
<li>
<a target="_blank" class="footer-link" href="https://github.com/ofxa/openfx">OFX @ Github</a>
</li>
<li>
<a title="Association details" class="footer-link" href="/contents/page/association_information">Association Information</a>
</li>
</ul>
<br>
Copyright  &copy;2023 The Open Effects Association
</footer>
</body>
</html>
