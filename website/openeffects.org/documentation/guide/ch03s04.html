<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
      <title>Suites, Hosts and APIs</title>
      <link rel="stylesheet" type="text/css" href="/assets/ofxStyle.css"></link>
      <meta name="generator" content="DocBook XSL Stylesheets V1.77.1"></meta>
      <link rel="home" href="/documentation/guide/index.html" title="OpenFX Plug-in API Programming Guide"></link>
      <link rel="up" href="/documentation/guide/ch03.html" title="Chapter 3. The Generic OFX Plug-in Architecture"></link>
      <link rel="prev" href="/documentation/guide/ch03s03.html" title="Identifying, Versioning and Defining an OFX Plug-in"></link>
      <link rel="next" href="/documentation/guide/ch03s05.html" title="Sequences of Operations Required to Load a Plug-in"></link>
      <link rel="stylesheet" type="text/css" href="/assets/ofx-docbook-nav.css"></link>
   </head>
   <body>
      <div id="ofx-main-nav">
         <table>
            <tr>
               <td>
                  <ul>
                     <li>
                        <a href="/">
                           <img alt="Ofx small" src="/assets/OFX_small.png"></img>
                        </a>
                     </li>
                     <li>
                        <a href="/">
                           Back to Main Site
                           <span class="glyph"></span>
                        </a>
                     </li>
                     <li>
                        <a href="/documentation/guide">Programming Guide</a>
                     </li>
                     <li>
                        <a href="/documentation/reference">Programming Reference</a>
                     </li>
                     <li>
                        <a href="/documentation/api_doc">API Reference</a>
                     </li>
                  </ul>
               </td>
            </tr>
         </table>
      </div>
      <div class="wrapper" id="guide">
         <div class="navheader">
            <table width="100%" summary="Navigation header">
               <tr>
                  <th colspan="3" align="center">Suites, Hosts and APIs</th>
               </tr>
               <tr>
                  <td width="20%" align="left">
                     <a accesskey="p" href="/documentation/guide/ch03s03.html">Prev</a>
                      
                  </td>
                  <th width="60%" align="center">Chapter 3. The Generic OFX Plug-in Architecture</th>
                  <td width="20%" align="right">
                      
                     <a accesskey="n" href="/documentation/guide/ch03s05.html">Next</a>
                  </td>
               </tr>
            </table>
            <hr></hr>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both">
                        <a id="idp140729791857088"></a>
                        Suites, Hosts and APIs
                     </h2>
                  </div>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title">
                           <a id="idp140729791857728"></a>
                           Function Suites
                        </h3>
                     </div>
                  </div>
               </div>
               <p>
                  A function suite is simply a struct filled with function pointers. Below is some code from the memory allocation suite found in
                  <code class="filename">ofxMemory.h</code>
                  .
               </p>
               <pre class="programlisting">
#define kOfxMemorySuite "OfxMemorySuite"

typedef struct OfxMemorySuiteV1 {
  OfxStatus (*memoryAlloc)(void *handle, size_t nBytes, void **allocatedData);
  OfxStatus (*memoryFree)(void *allocatedData);
 } OfxMemorySuiteV1;
</pre>
               <p>The use is fairly obvious, you call functions through the
        pointers in the struct. This has the effect of avoiding any symbolic
        dependencies from the plug-in to the host. Note two other things about
        this code listing. </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
               the suite has a cstring name associated with it, 
            </li>
                     <li class="listitem">
               the suite is versioned, via the "V1" suffix appended to the struct tag and typedef. 
            </li>
                  </ul>
               </div>
               <p>
                  The explicit naming and versioning of suites is how a plug-in fetches one, by calling the
                  <code class="function">fetchSuite</code>
                  function in the
                  <span class="structname">OfxHost</span>
                  struct which is passed to it during the boot strapping stage.
               </p>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title">
                           <a id="OfxHostStruct"></a>
                           The OfxHost Struct
                        </h3>
                     </div>
                  </div>
               </div>
               <p>
                  The
                  <span class="structname">OfxHost</span>
                  struct is how a host provides plug-ins with access to the various suites that make up the API they implement, as well as a host property set handle which a plug-in can ask questions of. The
                  <code class="function">setHost</code>
                  function in the
                  <span class="structname">OfxPlugin</span>
                  struct is passed a pointer to an
                  <span class="structname">OfxHost</span>
                  as the first thing to boot-strapping plug-in/host communication. The struct looks like...
               </p>
               <div class="blockquote">
                  <blockquote class="blockquote">
                     <pre class="programlisting">
typedef struct OfxHost {
  OfxPropertySetHandle host;
  void *(*fetchSuite)(OfxPropertySetHandle host, const char *suiteName, int suiteVersion);
} OfxHost;
  </pre>
                  </blockquote>
               </div>
               <p>
                  The
                  <span class="structname">OfxHost</span>
                  contains two elements,
               </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <em class="structfield">
                           <code>host</code>
                        </em>
                        - a property set handle that holds a set of properties which describe the host for the plug-in's API
                     </li>
                     <li class="listitem">
                        <em class="structfield">
                           <code>fetchSuite</code>
                        </em>
                        - a function handle used to fetch function suites from the host that implement the plug-in's API
                     </li>
                  </ul>
               </div>
               <p>
  </p>
               <p>
                  The
                  <em class="structfield">
                     <code>host</code>
                  </em>
                  property set handle in the
                  <span class="structname">OfxHost</span>
                  is not global across all plug-ins defined in the binary. It is only applicable for the plug-in whose 'setHost' function was called. Use this handle to fetch things like host application names, host capabilities and so on. The set of properties on an OFX Image Effect host is found in the section
                  <a class="link" href="">Properties on the Image Effect Host</a>
               </p>
               <p>
                  The
                  <code class="function">fetchSuite</code>
                  function is how a plug-in gets a suite from the host. It asks for a suite by giving the C string corresponding to that suite and the version of that suite. The host will return a pointer to that suite, or NULL if it does not support it. Please note that a suite cannot be fetched until the very first action is called on the plug-in, which is the load action.
               </p>
            </div>
         </div>
         <div class="navfooter">
            <hr></hr>
            <table width="100%" summary="Navigation footer">
               <tr>
                  <td width="40%" align="left">
                     <a accesskey="p" href="/documentation/guide/ch03s03.html">Prev</a>
                      
                  </td>
                  <td width="20%" align="center">
                     <a accesskey="u" href="/documentation/guide/ch03.html">Up</a>
                  </td>
                  <td width="40%" align="right">
                      
                     <a accesskey="n" href="/documentation/guide/ch03s05.html">Next</a>
                  </td>
               </tr>
               <tr>
                  <td width="40%" align="left" valign="top">Identifying, Versioning and Defining an OFX Plug-in </td>
                  <td width="20%" align="center">
                     <a accesskey="h" href="/documentation/guide/index.html">Home</a>
                  </td>
                  <td width="40%" align="right" valign="top"> Sequences of Operations Required to Load a Plug-in</td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>
