<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
      <title>Who Owns The Data?</title>
      <link rel="stylesheet" type="text/css" href="/assets/ofxStyle.css"></link>
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1"></meta>
      <link rel="home" href="/documentation/reference/index.html" title="The OFX Image Effect Plug-in API, 1.4, Programming Reference."></link>
      <link rel="up" href="/documentation/reference/ch02.html" title="Chapter 2. The Generic Core API"></link>
      <link rel="prev" href="/documentation/reference/ch02s08.html" title="Sequences of Operations Required to Load a Plug-in"></link>
      <link rel="next" href="/documentation/reference/ch03.html" title="Chapter 3. The Image Effect API"></link>
      <link rel="stylesheet" type="text/css" href="/assets/ofx-docbook-nav.css"></link>
   </head>
   <body>
      <div id="ofx-main-nav">
         <ul>
            <li>
               <a href="/">
                  <img alt="Ofx small" src="/assets/OFX_small.png"></img>
               </a>
            </li>
            <li>
               <a href="/">
                  Back to Main Site
                  <span class="glyph"></span>
               </a>
            </li>
            <li>
               <a href="/documentation/api_doc">API Reference</a>
            </li>
            <li>
               <a href="/documentation/reference">Programming Reference</a>
            </li>
            <li>
               <a href="https://github.com/ofxa/openfx/blob/master/Guide/Doc/ofxProgrammingGuide.adoc">Programming Guide</a>
            </li>
         </ul>
      </div>
      <div class="wrapper" id="reference">
         <div class="navheader">
            <table width="100%" summary="Navigation header">
               <tr>
                  <th colspan="3" align="center">Who Owns The Data?</th>
               </tr>
               <tr>
                  <td width="20%" align="left">
                     <a accesskey="p" href="/documentation/reference/ch02s08.html">Prev</a>
                      
                  </td>
                  <th width="60%" align="center">Chapter 2. The Generic Core API</th>
                  <td width="20%" align="right">
                      
                     <a accesskey="n" href="/documentation/reference/ch03.html">Next</a>
                  </td>
               </tr>
            </table>
            <hr></hr>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both">
                        <a id="idp11369552"></a>
                        Who Owns The Data?
                     </h2>
                  </div>
               </div>
            </div>
            <p>
               Objects are passed back and forth across the API, and in general, it is the thing that passes the data that is responsible for destroying it. For example the property set handle in the
               <a class="link" href="/documentation/reference/ch02s05.html" title="The OfxHost Struct">
                  <code class="code">OfxHost struct</code>
               </a>
               is managed by the host.
            </p>
            <p>
	There are a few explicit exceptions to this. For example, when an image effect asks for an image from a host
	it is passed back a property set handle which represents the image. That handle needs to later be disposed of
	by an effect, by an explicit function call back to the host. These few exceptions are documented with the suite
	functions that access the object.
      </p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title">
                           <a id="ArchitectureStrings"></a>
                           Strings
                        </h3>
                     </div>
                  </div>
               </div>
               <p>
                  A special case is made for strings. Strings are considered to be of two types,
                  <span class="emphasis">
                     <em>value</em>
                  </span>
                  strings and
                  <span class="emphasis">
                     <em>label</em>
                  </span>
                  strings. A label string is any string used by OFX to name a property or type. A value string is generally a string value of a property.
               </p>
               <p>
	  More specifically, a label string is a string passed across the API as one of the following...
	  </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem"> a property label (ie: the 'char *property' argument in the property suites)</li>
                     <li class="listitem">
                        a string argument to a suite function which must be one of a set of predefined set of values eg:
                        <code class="code">paramType</code>
                        argument to
                        <a class="link" href="/documentation/reference/re44.html" title="OfxParameterSuiteV1::paramDefine">OfxParameterSuiteV1::paramDefine</a>
                        , but not the
                        <code class="code">name</code>
                        argument)
                     </li>
                  </ul>
               </div>
               <p>
	</p>
               <p>
	  Label strings are considered to be static constant strings. When passed across the API the host/plug-in receiving the string neither needs to duplicate nor free the string, it can simply retain the orginal pointer passed over and use that in future, as it will not change. A host must be aware that when it unloads a plug-in all such pointers will be invalid, and be prepared to cope with such a situation.
	</p>
               <p>
	  A value string is a string passed across the API as one of the following...
	  </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">all value arguments to any of the property suite calls,</li>
                     <li class="listitem">
                        any other
                        <code class="code">char *</code>
                        argument to any other function.
                     </li>
                  </ul>
               </div>
               <p>
	</p>
               <p>
	  Value strings have no assumptions made about them. When one is passed across the
	  API, the thing that passed the string retains ownership of it. The thing getting the 
	  string is not responsible for freeing that string. The scope of the string's validity
	  is until the next OFX API function is called. For example, within a plugin
	</p>
               <div class="blockquote">
                  <blockquote class="blockquote">
                     <pre class="programlisting">
   // pointer to store the returned value of the host name
   char *returnedHostName;

   // get the host name
   propSuite-&gt;propGetString(hostHandle, kOfxPropName, 0, &amp;returnedHostName);

   // now make a copy of that before the next API call, as it may not be valid after it
   char *hostName = strdup(returnedHostName);

   paramSuite-&gt;getParamValue(instance, "myParam", &amp;value);
	</pre>
                  </blockquote>
               </div>
            </div>
         </div>
         <div class="navfooter">
            <hr></hr>
            <table width="100%" summary="Navigation footer">
               <tr>
                  <td width="40%" align="left">
                     <a accesskey="p" href="/documentation/reference/ch02s08.html">Prev</a>
                      
                  </td>
                  <td width="20%" align="center">
                     <a accesskey="u" href="/documentation/reference/ch02.html">Up</a>
                  </td>
                  <td width="40%" align="right">
                      
                     <a accesskey="n" href="/documentation/reference/ch03.html">Next</a>
                  </td>
               </tr>
               <tr>
                  <td width="40%" align="left" valign="top">Sequences of Operations Required to Load a Plug-in </td>
                  <td width="20%" align="center">
                     <a accesskey="h" href="/documentation/reference/index.html">Home</a>
                  </td>
                  <td width="40%" align="right" valign="top"> Chapter 3. The Image Effect API</td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>
